#include "EagleHashIP.h"
//#include "OLYMPUS_BaseType.h"
//using namespace OLYMPUS;

static const int P128 = 16;

const unsigned long long CRC64_Table[256] = {
	0x0000000000000000LL, 0xad93d23594c935a9LL, 0xf6b4765ebd5b5efbLL,
	0x5b27a46b29926b52LL, 0x40fb3e88ee7f885fLL, 0xed68ecbd7ab6bdf6LL,
	0xb64f48d65324d6a4LL, 0x1bdc9ae3c7ede30dLL, 0x81f67d11dcff10beLL,
	0x2c65af2448362517LL, 0x77420b4f61a44e45LL, 0xdad1d97af56d7becLL,
	0xc10d4399328098e1LL, 0x6c9e91aca649ad48LL, 0x37b935c78fdbc61aLL,
	0x9a2ae7f21b12f3b3LL, 0xae7f28162d3714d5LL, 0x03ecfa23b9fe217cLL,
	0x58cb5e48906c4a2eLL, 0xf5588c7d04a57f87LL, 0xee84169ec3489c8aLL,
	0x4317c4ab5781a923LL, 0x183060c07e13c271LL, 0xb5a3b2f5eadaf7d8LL,
	0x2f895507f1c8046bLL, 0x821a8732650131c2LL, 0xd93d23594c935a90LL,
	0x74aef16cd85a6f39LL, 0x6f726b8f1fb78c34LL, 0xc2e1b9ba8b7eb99dLL,
	0x99c61dd1a2ecd2cfLL, 0x3455cfe43625e766LL, 0xf16d8219cea71c03LL,
	0x5cfe502c5a6e29aaLL, 0x07d9f44773fc42f8LL, 0xaa4a2672e7357751LL,
	0xb196bc9120d8945cLL, 0x1c056ea4b411a1f5LL, 0x4722cacf9d83caa7LL,
	0xeab118fa094aff0eLL, 0x709bff0812580cbdLL, 0xdd082d3d86913914LL,
	0x862f8956af035246LL, 0x2bbc5b633bca67efLL, 0x3060c180fc2784e2LL,
	0x9df313b568eeb14bLL, 0xc6d4b7de417cda19LL, 0x6b4765ebd5b5efb0LL,
	0x5f12aa0fe39008d6LL, 0xf281783a77593d7fLL, 0xa9a6dc515ecb562dLL,
	0x04350e64ca026384LL, 0x1fe994870def8089LL, 0xb27a46b29926b520LL,
	0xe95de2d9b0b4de72LL, 0x44ce30ec247debdbLL, 0xdee4d71e3f6f1868LL,
	0x7377052baba62dc1LL, 0x2850a14082344693LL, 0x85c3737516fd733aLL,
	0x9e1fe996d1109037LL, 0x338c3ba345d9a59eLL, 0x68ab9fc86c4bceccLL,
	0xc5384dfdf882fb65LL, 0x4f48d60609870dafLL, 0xe2db04339d4e3806LL,
	0xb9fca058b4dc5354LL, 0x146f726d201566fdLL, 0x0fb3e88ee7f885f0LL,
	0xa2203abb7331b059LL, 0xf9079ed05aa3db0bLL, 0x54944ce5ce6aeea2LL,
	0xcebeab17d5781d11LL, 0x632d792241b128b8LL, 0x380add49682343eaLL,
	0x95990f7cfcea7643LL, 0x8e45959f3b07954eLL, 0x23d647aaafcea0e7LL,
	0x78f1e3c1865ccbb5LL, 0xd56231f41295fe1cLL, 0xe137fe1024b0197aLL,
	0x4ca42c25b0792cd3LL, 0x1783884e99eb4781LL, 0xba105a7b0d227228LL,
	0xa1ccc098cacf9125LL, 0x0c5f12ad5e06a48cLL, 0x5778b6c67794cfdeLL,
	0xfaeb64f3e35dfa77LL, 0x60c18301f84f09c4LL, 0xcd5251346c863c6dLL,
	0x9675f55f4514573fLL, 0x3be6276ad1dd6296LL, 0x203abd891630819bLL,
	0x8da96fbc82f9b432LL, 0xd68ecbd7ab6bdf60LL, 0x7b1d19e23fa2eac9LL,
	0xbe25541fc72011acLL, 0x13b6862a53e92405LL, 0x489122417a7b4f57LL,
	0xe502f074eeb27afeLL, 0xfede6a97295f99f3LL, 0x534db8a2bd96ac5aLL,
	0x086a1cc99404c708LL, 0xa5f9cefc00cdf2a1LL, 0x3fd3290e1bdf0112LL,
	0x9240fb3b8f1634bbLL, 0xc9675f50a6845fe9LL, 0x64f48d65324d6a40LL,
	0x7f281786f5a0894dLL, 0xd2bbc5b36169bce4LL, 0x899c61d848fbd7b6LL,
	0x240fb3eddc32e21fLL, 0x105a7c09ea170579LL, 0xbdc9ae3c7ede30d0LL,
	0xe6ee0a57574c5b82LL, 0x4b7dd862c3856e2bLL, 0x50a1428104688d26LL,
	0xfd3290b490a1b88fLL, 0xa61534dfb933d3ddLL, 0x0b86e6ea2dfae674LL,
	0x91ac011836e815c7LL, 0x3c3fd32da221206eLL, 0x671877468bb34b3cLL,
	0xca8ba5731f7a7e95LL, 0xd1573f90d8979d98LL, 0x7cc4eda54c5ea831LL,
	0x27e349ce65ccc363LL, 0x8a709bfbf105f6caLL, 0x9e91ac0c130e1b5eLL,
	0x33027e3987c72ef7LL, 0x6825da52ae5545a5LL, 0xc5b608673a9c700cLL,
	0xde6a9284fd719301LL, 0x73f940b169b8a6a8LL, 0x28dee4da402acdfaLL,
	0x854d36efd4e3f853LL, 0x1f67d11dcff10be0LL, 0xb2f403285b383e49LL,
	0xe9d3a74372aa551bLL, 0x44407576e66360b2LL, 0x5f9cef95218e83bfLL,
	0xf20f3da0b547b616LL, 0xa92899cb9cd5dd44LL, 0x04bb4bfe081ce8edLL,
	0x30ee841a3e390f8bLL, 0x9d7d562faaf03a22LL, 0xc65af24483625170LL,
	0x6bc9207117ab64d9LL, 0x7015ba92d04687d4LL, 0xdd8668a7448fb27dLL,
	0x86a1cccc6d1dd92fLL, 0x2b321ef9f9d4ec86LL, 0xb118f90be2c61f35LL,
	0x1c8b2b3e760f2a9cLL, 0x47ac8f555f9d41ceLL, 0xea3f5d60cb547467LL,
	0xf1e3c7830cb9976aLL, 0x5c7015b69870a2c3LL, 0x0757b1ddb1e2c991LL,
	0xaac463e8252bfc38LL, 0x6ffc2e15dda9075dLL, 0xc26ffc20496032f4LL,
	0x9948584b60f259a6LL, 0x34db8a7ef43b6c0fLL, 0x2f07109d33d68f02LL,
	0x8294c2a8a71fbaabLL, 0xd9b366c38e8dd1f9LL, 0x7420b4f61a44e450LL,
	0xee0a5304015617e3LL, 0x43998131959f224aLL, 0x18be255abc0d4918LL,
	0xb52df76f28c47cb1LL, 0xaef16d8cef299fbcLL, 0x0362bfb97be0aa15LL,
	0x58451bd25272c147LL, 0xf5d6c9e7c6bbf4eeLL, 0xc1830603f09e1388LL,
	0x6c10d43664572621LL, 0x3737705d4dc54d73LL, 0x9aa4a268d90c78daLL,
	0x8178388b1ee19bd7LL, 0x2cebeabe8a28ae7eLL, 0x77cc4ed5a3bac52cLL,
	0xda5f9ce03773f085LL, 0x40757b122c610336LL, 0xede6a927b8a8369fLL,
	0xb6c10d4c913a5dcdLL, 0x1b52df7905f36864LL, 0x008e459ac21e8b69LL,
	0xad1d97af56d7bec0LL, 0xf63a33c47f45d592LL, 0x5ba9e1f1eb8ce03bLL,
	0xd1d97a0a1a8916f1LL, 0x7c4aa83f8e402358LL, 0x276d0c54a7d2480aLL,
	0x8afede61331b7da3LL, 0x91224482f4f69eaeLL, 0x3cb196b7603fab07LL,
	0x679632dc49adc055LL, 0xca05e0e9dd64f5fcLL, 0x502f071bc676064fLL,
	0xfdbcd52e52bf33e6LL, 0xa69b71457b2d58b4LL, 0x0b08a370efe46d1dLL,
	0x10d4399328098e10LL, 0xbd47eba6bcc0bbb9LL, 0xe6604fcd9552d0ebLL,
	0x4bf39df8019be542LL, 0x7fa6521c37be0224LL, 0xd2358029a377378dLL,
	0x891224428ae55cdfLL, 0x2481f6771e2c6976LL, 0x3f5d6c94d9c18a7bLL,
	0x92cebea14d08bfd2LL, 0xc9e91aca649ad480LL, 0x647ac8fff053e129LL,
	0xfe502f0deb41129aLL, 0x53c3fd387f882733LL, 0x08e45953561a4c61LL,
	0xa5778b66c2d379c8LL, 0xbeab1185053e9ac5LL, 0x1338c3b091f7af6cLL,
	0x481f67dbb865c43eLL, 0xe58cb5ee2cacf197LL, 0x20b4f813d42e0af2LL,
	0x8d272a2640e73f5bLL, 0xd6008e4d69755409LL, 0x7b935c78fdbc61a0LL,
	0x604fc69b3a5182adLL, 0xcddc14aeae98b704LL, 0x96fbb0c5870adc56LL,
	0x3b6862f013c3e9ffLL, 0xa142850208d11a4cLL, 0x0cd157379c182fe5LL,
	0x57f6f35cb58a44b7LL, 0xfa6521692143711eLL, 0xe1b9bb8ae6ae9213LL,
	0x4c2a69bf7267a7baLL, 0x170dcdd45bf5cce8LL, 0xba9e1fe1cf3cf941LL,
	0x8ecbd005f9191e27LL, 0x235802306dd02b8eLL, 0x787fa65b444240dcLL,
	0xd5ec746ed08b7575LL, 0xce30ee8d17669678LL, 0x63a33cb883afa3d1LL,
	0x388498d3aa3dc883LL, 0x95174ae63ef4fd2aLL, 0x0f3dad1425e60e99LL,
	0xa2ae7f21b12f3b30LL, 0xf989db4a98bd5062LL, 0x541a097f0c7465cbLL,
	0x4fc6939ccb9986c6LL, 0xe25541a95f50b36fLL, 0xb972e5c276c2d83dLL,
	0x14e137f7e20bed94LL };

const unsigned char sbox[16][16] = { 0x63, 0x7C, 0x77, 0x7B,
	0xF2, 0x6B, 0x6F, 0xC5, 0x30, 0x01, 0x67, 0x2B, 0xFE, 0xD7, 0xAB, 0x76,
	0xCA, 0x82, 0xC9, 0x7D, 0xFA, 0x59, 0x47, 0xF0, 0xAD, 0xD4, 0xA2, 0xAF,
	0x9C, 0xA4, 0x72, 0xC0, 0xB7, 0xFD, 0x93, 0x26, 0x36, 0x3F, 0xF7, 0xCC,
	0x34, 0xA5, 0xE5, 0xF1, 0x71, 0xD8, 0x31, 0x15, 0x04, 0xC7, 0x23, 0xC3,
	0x18, 0x96, 0x05, 0x9A, 0x07, 0x12, 0x80, 0xE2, 0xEB, 0x27, 0xB2, 0x75,
	0x09, 0x83, 0x2C, 0x1A, 0x1B, 0x6E, 0x5A, 0xA0, 0x52, 0x3B, 0xD6, 0xB3,
	0x29, 0xE3, 0x2F, 0x84, 0x53, 0xD1, 0x00, 0xED, 0x20, 0xFC, 0xB1, 0x5B,
	0x6A, 0xCB, 0xBE, 0x39, 0x4A, 0x4C, 0x58, 0xCF, 0xD0, 0xEF, 0xAA, 0xFB,
	0x43, 0x4D, 0x33, 0x85, 0x45, 0xF9, 0x02, 0x7F, 0x50, 0x3C, 0x9F, 0xA8,
	0x51, 0xA3, 0x40, 0x8F, 0x92, 0x9D, 0x38, 0xF5, 0xBC, 0xB6, 0xDA, 0x21,
	0x10, 0xFF, 0xF3, 0xD2, 0xCD, 0x0C, 0x13, 0xEC, 0x5F, 0x97, 0x44, 0x17,
	0xC4, 0xA7, 0x7E, 0x3D, 0x64, 0x5D, 0x19, 0x73, 0x60, 0x81, 0x4F, 0xDC,
	0x22, 0x2A, 0x90, 0x88, 0x46, 0xEE, 0xB8, 0x14, 0xDE, 0x5E, 0x0B, 0xDB,
	0xE0, 0x32, 0x3A, 0x0A, 0x49, 0x06, 0x24, 0x5C, 0xC2, 0xD3, 0xAC, 0x62,
	0x91, 0x95, 0xE4, 0x79, 0xE7, 0xC8, 0x37, 0x6D, 0x8D, 0xD5, 0x4E, 0xA9,
	0x6C, 0x56, 0xF4, 0xEA, 0x65, 0x7A, 0xAE, 0x08, 0xBA, 0x78, 0x25, 0x2E,
	0x1C, 0xA6, 0xB4, 0xC6, 0xE8, 0xDD, 0x74, 0x1F, 0x4B, 0xBD, 0x8B, 0x8A,
	0x70, 0x3E, 0xB5, 0x66, 0x48, 0x03, 0xF6, 0x0E, 0x61, 0x35, 0x57, 0xB9,
	0x86, 0xC1, 0x1D, 0x9E, 0xE1, 0xF8, 0x98, 0x11, 0x69, 0xD9, 0x8E, 0x94,
	0x9B, 0x1E, 0x87, 0xE9, 0xCE, 0x55, 0x28, 0xDF, 0x8C, 0xA1, 0x89, 0x0D,
	0xBF, 0xE6, 0x42, 0x68, 0x41, 0x99, 0x2D, 0x0F, 0xB0, 0x54, 0xBB, 0x16 };

static const unsigned char invsbox[16][16] = { 0x52, 0x09, 0x6A,
	0xD5, 0x30, 0x36, 0xA5, 0x38, 0xBF, 0x40, 0xA3, 0x9E, 0x81, 0xF3, 0xD7,
	0xFB, 0x7C, 0xE3, 0x39, 0x82, 0x9B, 0x2F, 0xFF, 0x87, 0x34, 0x8E, 0x43,
	0x44, 0xC4, 0xDE, 0xE9, 0xCB, 0x54, 0x7B, 0x94, 0x32, 0xA6, 0xC2, 0x23,
	0x3D, 0xEE, 0x4C, 0x95, 0x0B, 0x42, 0xFA, 0xC3, 0x4E, 0x08, 0x2E, 0xA1,
	0x66, 0x28, 0xD9, 0x24, 0xB2, 0x76, 0x5B, 0xA2, 0x49, 0x6D, 0x8B, 0xD1,
	0x25, 0x72, 0xF8, 0xF6, 0x64, 0x86, 0x68, 0x98, 0x16, 0xD4, 0xA4, 0x5C,
	0xCC, 0x5D, 0x65, 0xB6, 0x92, 0x6C, 0x70, 0x48, 0x50, 0xFD, 0xED, 0xB9,
	0xDA, 0x5E, 0x15, 0x46, 0x57, 0xA7, 0x8D, 0x9D, 0x84, 0x90, 0xD8, 0xAB,
	0x00, 0x8C, 0xBC, 0xD3, 0x0A, 0xF7, 0xE4, 0x58, 0x05, 0xB8, 0xB3, 0x45,
	0x06, 0xD0, 0x2C, 0x1E, 0x8F, 0xCA, 0x3F, 0x0F, 0x02, 0xC1, 0xAF, 0xBD,
	0x03, 0x01, 0x13, 0x8A, 0x6B, 0x3A, 0x91, 0x11, 0x41, 0x4F, 0x67, 0xDC,
	0xEA, 0x97, 0xF2, 0xCF, 0xCE, 0xF0, 0xB4, 0xE6, 0x73, 0x96, 0xAC, 0x74,
	0x22, 0xE7, 0xAD, 0x35, 0x85, 0xE2, 0xF9, 0x37, 0xE8, 0x1C, 0x75, 0xDF,
	0x6E, 0x47, 0xF1, 0x1A, 0x71, 0x1D, 0x29, 0xC5, 0x89, 0x6F, 0xB7, 0x62,
	0x0E, 0xAA, 0x18, 0xBE, 0x1B, 0xFC, 0x56, 0x3E, 0x4B, 0xC6, 0xD2, 0x79,
	0x20, 0x9A, 0xDB, 0xC0, 0xFE, 0x78, 0xCD, 0x5A, 0xF4, 0x1F, 0xDD, 0xA8,
	0x33, 0x88, 0x07, 0xC7, 0x31, 0xB1, 0x12, 0x10, 0x59, 0x27, 0x80, 0xEC,
	0x5F, 0x60, 0x51, 0x7F, 0xA9, 0x19, 0xB5, 0x4A, 0x0D, 0x2D, 0xE5, 0x7A,
	0x9F, 0x93, 0xC9, 0x9C, 0xEF, 0xA0, 0xE0, 0x3B, 0x4D, 0xAE, 0x2A, 0xF5,
	0xB0, 0xC8, 0xEB, 0xBB, 0x3C, 0x83, 0x53, 0x99, 0x61, 0x17, 0x2B, 0x04,
	0x7E, 0xBA, 0x77, 0xD6, 0x26, 0xE1, 0x69, 0x14, 0x63, 0x55, 0x21, 0x0C,
	0x7D };

static const unsigned char Alternative_sbox[16][16]  = { 0x08, 0xF8,
	0x37, 0x68, 0xFE, 0x44, 0x57, 0x1E, 0xF5, 0x67, 0x1B, 0x59, 0xA1, 0x48,
	0x2E, 0x8A, 0x34, 0xCF, 0x41, 0x93, 0xB2, 0x65, 0xFC, 0xC4, 0x5C, 0x02,
	0x53, 0x3D, 0xCE, 0x18, 0x99, 0x3E, 0xA0, 0xE7, 0x5E, 0xEB, 0x87, 0x6B,
	0xA9, 0xAE, 0xE6, 0x66, 0x54, 0x8F, 0xE0, 0xD0, 0x9F, 0x56, 0x60, 0x8B,
	0x82, 0xFD, 0x76, 0xD9, 0x74, 0x91, 0x15, 0x00, 0xEC, 0xDE, 0x23, 0xAF,
	0x2A, 0x70, 0x17, 0x28, 0xC5, 0x33, 0x75, 0x81, 0x8D, 0xB1, 0x9A, 0x9B,
	0x09, 0xC2, 0xC3, 0x21, 0x4A, 0x0E, 0x8E, 0x7F, 0x0A, 0xB5, 0xFF, 0x96,
	0x05, 0x2F, 0x4C, 0x94, 0xAC, 0x2B, 0xE1, 0xE9, 0xEA, 0x92, 0xC8, 0xDA,
	0xD2, 0xB7, 0x06, 0xF9, 0xAB, 0xF3, 0xEE, 0xCB, 0x78, 0x6C, 0xFB, 0xF0,
	0xBC, 0x73, 0xEF, 0x61, 0x97, 0xDF, 0x04, 0x30, 0xF1, 0x22, 0xCD, 0xAA,
	0x01, 0x47, 0x19, 0x31, 0x2C, 0x7B, 0xFA, 0xD5, 0x0C, 0x3F, 0xD4, 0xB6,
	0x29, 0x9E, 0xB0, 0x1A, 0x58, 0x4F, 0x10, 0xBD, 0xB8, 0x6D, 0x7D, 0x63,
	0x36, 0xF4, 0x43, 0x5B, 0x5D, 0x0D, 0x16, 0x0F, 0xD8, 0x50, 0x46, 0xF7,
	0xCA, 0xE4, 0x4E, 0x42, 0x3A, 0xA5, 0x1D, 0xDD, 0x6F, 0xCC, 0xBE, 0x95,
	0x35, 0xD1, 0x0B, 0xE5, 0x85, 0x12, 0x84, 0x1F, 0x20, 0x4D, 0x5F, 0x49,
	0x52, 0xA2, 0x07, 0x24, 0x98, 0x79, 0xC6, 0xC0, 0xE2, 0x71, 0xD7, 0x2D,
	0x26, 0x88, 0xB9, 0xD3, 0x7A, 0x1C, 0x55, 0x14, 0x7C, 0x39, 0xD6, 0x9C,
	0xF6, 0x32, 0x11, 0xC1, 0x89, 0xC7, 0xB3, 0x03, 0x80, 0x38, 0x69, 0xE8,
	0xA8, 0x13, 0xBB, 0xC9, 0x72, 0xAD, 0x5A, 0xA3, 0x83, 0x64, 0x7E, 0xA4,
	0xBA, 0xB4, 0x40, 0x62, 0x77, 0x6A, 0xE3, 0xBF, 0x86, 0x6E, 0x4B, 0x8C,
	0x9D, 0x51, 0xDC, 0x90, 0x45, 0x25, 0xA7, 0x3B, 0x3C, 0xA6, 0xDB, 0xF2,
	0xED, 0x27 };

static const unsigned char Alternative_invsbox[16][16] = { 0x39,
	0x7A, 0x19, 0xD5, 0x74, 0x56, 0x64, 0xB8, 0x00, 0x4A, 0x52, 0xAC, 0x82,
	0x97, 0x4F, 0x99, 0x8C, 0xD0, 0xAF, 0xDB, 0xC9, 0x38, 0x98, 0x40, 0x1D,
	0x7C, 0x89, 0x0A, 0xC7, 0xA4, 0x07, 0xB1, 0xB2, 0x4D, 0x77, 0x3C, 0xB9,
	0xF7, 0xC2, 0xFF, 0x41, 0x86, 0x3E, 0x5B, 0x7E, 0xC1, 0x0E, 0x57, 0x75,
	0x7D, 0xCF, 0x43, 0x10, 0xAA, 0x92, 0x02, 0xD7, 0xCB, 0xA2, 0xF9, 0xFA,
	0x1B, 0x1F, 0x83, 0xE8, 0x12, 0xA1, 0x94, 0x05, 0xF6, 0x9C, 0x7B, 0x0D,
	0xB5, 0x4E, 0xF0, 0x58, 0xB3, 0xA0, 0x8B, 0x9B, 0xF3, 0xB6, 0x1A, 0x2A,
	0xC8, 0x2F, 0x06, 0x8A, 0x0B, 0xE0, 0x95, 0x18, 0x96, 0x22, 0xB4, 0x30,
	0x71, 0xE9, 0x91, 0xE3, 0x15, 0x29, 0x09, 0x03, 0xD8, 0xEB, 0x25, 0x6B,
	0x8F, 0xEF, 0xA6, 0x3F, 0xBF, 0xDE, 0x6F, 0x36, 0x44, 0x34, 0xEA, 0x6A,
	0xBB, 0xC6, 0x7F, 0xCA, 0x90, 0xE4, 0x51, 0xD6, 0x45, 0x32, 0xE2, 0xB0,
	0xAE, 0xEE, 0x24, 0xC3, 0xD2, 0x0F, 0x31, 0xF1, 0x46, 0x50, 0x2B, 0xF5,
	0x37, 0x5F, 0x13, 0x59, 0xA9, 0x55, 0x72, 0xBA, 0x1E, 0x48, 0x49, 0xCD,
	0xF2, 0x87, 0x2E, 0x20, 0x0C, 0xB7, 0xE1, 0xE5, 0xA3, 0xFB, 0xF8, 0xDA,
	0x26, 0x79, 0x66, 0x5A, 0xDF, 0x27, 0x3D, 0x88, 0x47, 0x14, 0xD4, 0xE7,
	0x53, 0x85, 0x63, 0x8E, 0xC4, 0xE6, 0xDC, 0x6E, 0x8D, 0xA8, 0xED, 0xBD,
	0xD1, 0x4B, 0x4C, 0x17, 0x42, 0xBC, 0xD3, 0x60, 0xDD, 0x9E, 0x69, 0xA7,
	0x78, 0x1C, 0x11, 0x2D, 0xAB, 0x62, 0xC5, 0x84, 0x81, 0xCC, 0xC0, 0x9A,
	0x35, 0x61, 0xFC, 0xF4, 0xA5, 0x3B, 0x73, 0x2C, 0x5C, 0xBE, 0xEC, 0x9F,
	0xAD, 0x28, 0x21, 0xD9, 0x5D, 0x5E, 0x23, 0x3A, 0xFE, 0x68, 0x70, 0x6D,
	0x76, 0xFD, 0x67, 0x93, 0x08, 0xCE, 0x9D, 0x01, 0x65, 0x80, 0x6C, 0x16,
	0x33, 0x04, 0x54 };

static const unsigned char new_sbox2[256] = { 0x61, 0xDE, 0xF8,
	0x1A, 0x30, 0x00, 0xA6, 0x9F, 0x25, 0x7B, 0x88, 0x16, 0x34, 0x7E, 0x6B,
	0x1D, 0x9C, 0x6E, 0xC5, 0x5F, 0x73, 0x49, 0x65, 0xBF, 0xDC, 0x36, 0x6D,
	0x64, 0xF6, 0x0D, 0x11, 0xCA, 0xF5, 0x05, 0x1F, 0xCC, 0x7D, 0xE3, 0x82,
	0xFC, 0x5E, 0x20, 0xD3, 0xBD, 0xCD, 0x42, 0x45, 0xBA, 0xF7, 0xAF, 0x52,
	0x80, 0x0C, 0xB9, 0xBE, 0x02, 0x0E, 0xCF, 0x76, 0x91, 0x2A, 0x6C, 0xC4,
	0x2B, 0x68, 0xC6, 0xD2, 0x1B, 0xC0, 0x5C, 0xA4, 0x7F, 0xF0, 0xEB, 0x2C,
	0x8C, 0xA8, 0x3B, 0x4B, 0x5A, 0x12, 0x48, 0xE0, 0x27, 0x8D, 0x74, 0xC3,
	0x63, 0xB5, 0x39, 0xC2, 0x46, 0xDF, 0xF4, 0x8A, 0x40, 0x26, 0x32, 0x43,
	0x67, 0x47, 0x99, 0x71, 0x08, 0x03, 0x70, 0xC7, 0x31, 0x66, 0x4C, 0x55,
	0x23, 0x56, 0x3F, 0x06, 0x7A, 0xBC, 0x33, 0x4A, 0xD1, 0x5D, 0x44, 0x0B,
	0xF2, 0x59, 0x41, 0xEF, 0xB8, 0x72, 0x35, 0x92, 0xFD, 0xED, 0x93, 0x0F,
	0xA0, 0x78, 0x8E, 0xD7, 0x9D, 0x4D, 0xC1, 0x97, 0xB1, 0xD5, 0xA9, 0x9A,
	0x84, 0x15, 0xFA, 0xFB, 0xF1, 0x53, 0xC9, 0x57, 0x24, 0x19, 0x60, 0x9E,
	0xA7, 0xA1, 0xC8, 0x94, 0x3A, 0x6A, 0x18, 0x83, 0xE7, 0xA5, 0xFF, 0xE9,
	0x62, 0x07, 0x1C, 0xEA, 0x4E, 0x38, 0x0A, 0xAD, 0xB6, 0x22, 0x2D, 0xE6,
	0x7C, 0xB3, 0xBB, 0x96, 0xD4, 0xE4, 0xAB, 0x69, 0xDD, 0x87, 0xA2, 0x8B,
	0x10, 0x86, 0xAE, 0x6F, 0x09, 0xCB, 0xE2, 0xEC, 0xB0, 0x50, 0xAC, 0xFE,
	0x01, 0xD9, 0xA3, 0x58, 0xB2, 0xD6, 0x21, 0xDB, 0xE8, 0xEE, 0xE1, 0x75,
	0x3E, 0xDA, 0x81, 0xD8, 0xB4, 0x79, 0x04, 0x13, 0x1E, 0x9B, 0x51, 0x95,
	0x77, 0xB7, 0x5B, 0xF9, 0x3C, 0x90, 0x2E, 0x2F, 0x54, 0x28, 0xD0, 0xE5,
	0x17, 0x89, 0x4F, 0x98, 0x37, 0x85, 0x3D, 0xAA, 0xCE, 0x8F, 0xF3, 0x29,
	0x14 };

static const unsigned char new_sbox3[256] = { 0xC5, 0x69, 0xF4,
	0xBE, 0x20, 0x0E, 0xF2, 0x6D, 0xE9, 0x15, 0x98, 0xCA, 0xF8, 0x96, 0xA1,
	0x64, 0xA4, 0x24, 0xE1, 0x59, 0xFA, 0x5F, 0xC1, 0x8E, 0x90, 0xA6, 0x73,
	0x38, 0x92, 0x1B, 0x47, 0x9F, 0x35, 0xD3, 0x52, 0xEF, 0x54, 0xAB, 0x75,
	0xB1, 0x22, 0x93, 0x9C, 0xC7, 0xE0, 0x4A, 0xFC, 0xCB, 0x88, 0xC4, 0x31,
	0xF3, 0x11, 0x4B, 0x34, 0x6F, 0x74, 0x23, 0x40, 0x3E, 0x3A, 0xEB, 0x0C,
	0x8B, 0x18, 0xCF, 0x3B, 0xAE, 0x61, 0xF0, 0xA8, 0x07, 0x10, 0xFD, 0x5A,
	0xF5, 0x65, 0xEE, 0x84, 0x6B, 0x32, 0x26, 0x82, 0xE7, 0x14, 0x4D, 0x30,
	0x4F, 0x80, 0xA2, 0xA0, 0x68, 0x78, 0xD5, 0xBD, 0xFF, 0x85, 0x7C, 0xD1,
	0x3D, 0xB3, 0x7E, 0xAC, 0xC8, 0x05, 0x8D, 0x0A, 0xBB, 0x72, 0x5D, 0x87,
	0x9E, 0x42, 0x2D, 0x62, 0x1D, 0x6C, 0x0B, 0x66, 0xBA, 0xF1, 0xF6, 0x21,
	0xCC, 0xC0, 0x5E, 0x91, 0x5B, 0x50, 0x9B, 0x86, 0xE2, 0x3F, 0xE3, 0x4E,
	0x89, 0x28, 0x83, 0xB2, 0xC6, 0x79, 0x09, 0xB9, 0xDE, 0x9D, 0x51, 0x1A,
	0x7D, 0xA9, 0xE6, 0x39, 0x77, 0x7F, 0xDA, 0x97, 0xED, 0x2E, 0xE5, 0x2F,
	0x01, 0xA7, 0x8C, 0x76, 0x6A, 0x43, 0x95, 0x36, 0xDC, 0xD7, 0x58, 0xB5,
	0xDB, 0xFB, 0xDF, 0xA3, 0x5C, 0x7B, 0xD0, 0xE8, 0x94, 0xA5, 0xD6, 0xF9,
	0x12, 0x17, 0x19, 0xBF, 0x2C, 0x06, 0xCD, 0xF7, 0x63, 0xEA, 0x02, 0x25,
	0x08, 0xAF, 0x44, 0x71, 0xDD, 0x53, 0xB7, 0x46, 0x2A, 0x55, 0x0D, 0x57,
	0x99, 0x6E, 0xAD, 0x7A, 0x13, 0x27, 0xE4, 0xB6, 0x00, 0xD9, 0x48, 0xC9,
	0x1F, 0xB4, 0xFE, 0x49, 0x04, 0xB0, 0x45, 0x3C, 0xCE, 0x1C, 0xC3, 0xB8,
	0xC2, 0xEC, 0x67, 0x0F, 0x8F, 0x1E, 0x8A, 0x70, 0x81, 0x16, 0x33, 0x56,
	0x03, 0x37, 0xAA, 0x4C, 0x41, 0xD8, 0x9A, 0x2B, 0xD2, 0x29, 0x60, 0xBC,
	0xD4 };

static const unsigned char new_sbox4[256] = { 0x4B, 0x3A, 0x21,
	0x85, 0xB2, 0x18, 0x6E, 0xFD, 0x69, 0xE5, 0x5B, 0x27, 0xFF, 0x39, 0x62,
	0x8A, 0xDA, 0x50, 0x75, 0xDE, 0x04, 0x3C, 0xE0, 0xA4, 0xCD, 0x9E, 0xFC,
	0x9F, 0xF9, 0xE7, 0x5C, 0x63, 0x52, 0x48, 0x51, 0x31, 0xA7, 0x3B, 0x5A,
	0x90, 0xA8, 0xFA, 0xB3, 0x73, 0xEE, 0x67, 0x4D, 0xCE, 0x16, 0x49, 0x15,
	0xD0, 0x02, 0xBE, 0x99, 0x94, 0xAC, 0xEC, 0x3D, 0xA5, 0x9D, 0xA3, 0xB8,
	0x92, 0x98, 0x19, 0x71, 0x5F, 0x01, 0x1E, 0x8E, 0xE4, 0xA6, 0xE3, 0xF2,
	0x30, 0xE9, 0xC0, 0x76, 0x46, 0x0F, 0x83, 0xB4, 0x6C, 0x07, 0x12, 0xD2,
	0x38, 0xF1, 0xD5, 0x0C, 0x4F, 0xFB, 0xA1, 0x2E, 0xBF, 0x97, 0x0E, 0x86,
	0xB5, 0x82, 0x5E, 0xCC, 0xE6, 0xAA, 0x81, 0xB7, 0x0D, 0x79, 0x43, 0x58,
	0xC4, 0x6A, 0x96, 0x84, 0x7B, 0x1C, 0x9B, 0xE1, 0x95, 0xE8, 0xEA, 0x7A,
	0x37, 0xF5, 0x44, 0x03, 0x33, 0xBB, 0x66, 0x3F, 0xF3, 0x64, 0x6F, 0x6D,
	0xAB, 0x08, 0xCA, 0x8F, 0x2D, 0xC7, 0x14, 0x40, 0xBA, 0xAD, 0xED, 0x25,
	0x47, 0x7F, 0x87, 0xDD, 0xF0, 0x54, 0x4C, 0x7C, 0xA9, 0xD6, 0xB6, 0x0A,
	0xCB, 0xD1, 0xC5, 0x2B, 0x65, 0xAF, 0x7D, 0xFE, 0xA2, 0x09, 0xC6, 0x53,
	0x6B, 0xF8, 0x70, 0x42, 0x5D, 0xDB, 0x88, 0xF4, 0xEF, 0x20, 0xF7, 0xEB,
	0x05, 0xC3, 0xD8, 0x7E, 0xB1, 0x13, 0x17, 0x2C, 0x2F, 0xD3, 0x8B, 0x23,
	0x59, 0xBC, 0x57, 0x9A, 0xC8, 0x26, 0xC1, 0x41, 0xB0, 0xD9, 0xD4, 0xDC,
	0x3E, 0xCF, 0x68, 0x10, 0xF6, 0x36, 0x61, 0x91, 0x80, 0x78, 0x34, 0x1A,
	0x4E, 0xBD, 0x74, 0x06, 0xB9, 0xC2, 0x8C, 0x24, 0x89, 0x45, 0x29, 0x1B,
	0x56, 0x00, 0xC9, 0x32, 0x35, 0x2A, 0x55, 0x9C, 0x4A, 0x8D, 0x60, 0x1D,
	0x1F, 0xA0, 0x93, 0xE2, 0x22, 0x0B, 0xDF, 0xD7, 0xAE, 0x77, 0x72, 0x28,
	0x11 };
static const unsigned char new_sbox5[256] = { 0xDB, 0x59, 0xA9,
	0xF7, 0xC0, 0xFB, 0x0D, 0x85, 0xB5, 0x15, 0x9C, 0x26, 0x21, 0x77, 0x34,
	0x1A, 0x56, 0x2D, 0x7B, 0xE4, 0x81, 0x63, 0x53, 0x44, 0x1F, 0x16, 0x4E,
	0x38, 0x66, 0xC2, 0x00, 0xB4, 0xAB, 0xD5, 0x90, 0xF5, 0x4B, 0x8D, 0x5F,
	0xED, 0x76, 0xA2, 0x24, 0xD2, 0x5B, 0xF6, 0x7D, 0xB3, 0x9E, 0xD7, 0x8F,
	0x0C, 0x47, 0x6F, 0xB7, 0xEF, 0xA0, 0xBA, 0xE8, 0x0E, 0xCD, 0x30, 0x19,
	0xA6, 0x52, 0xA8, 0x9B, 0x3A, 0x50, 0x6A, 0x32, 0x3D, 0x08, 0x1D, 0xEE,
	0xB1, 0xA1, 0xF1, 0x45, 0x9D, 0x18, 0x2A, 0x12, 0xF0, 0x29, 0xEB, 0x33,
	0x40, 0xCB, 0x49, 0xF9, 0x60, 0x69, 0xCF, 0xDD, 0x5D, 0x1E, 0xA7, 0x1B,
	0x78, 0x93, 0xA5, 0x5E, 0xE1, 0x4D, 0x8B, 0x5C, 0x91, 0xFF, 0xAA, 0x6B,
	0xBD, 0x92, 0xE6, 0x39, 0x06, 0x2F, 0x07, 0x73, 0x2C, 0x68, 0xF3, 0x8C,
	0xDF, 0xDC, 0xFD, 0x48, 0x27, 0xD1, 0xBC, 0x97, 0x6E, 0x84, 0x67, 0x0F,
	0xC8, 0x55, 0x82, 0x79, 0xB2, 0x64, 0xBB, 0xB8, 0x13, 0x8A, 0x4C, 0xC7,
	0xF4, 0xA3, 0xC9, 0x86, 0xE7, 0x88, 0x7A, 0x46, 0x42, 0xA4, 0x51, 0x7C,
	0xD6, 0xCE, 0xCA, 0xB9, 0x7F, 0xD9, 0xF8, 0xD0, 0x4F, 0x22, 0x11, 0x28,
	0xB6, 0xAE, 0x2B, 0x57, 0x61, 0x94, 0xD4, 0x05, 0x0A, 0x31, 0x0B, 0xE2,
	0xAC, 0x70, 0x17, 0xAD, 0x3B, 0xFC, 0x36, 0x35, 0x14, 0x10, 0xBF, 0xFA,
	0x3E, 0xE9, 0x74, 0x83, 0x8E, 0xEC, 0x98, 0xAF, 0x01, 0xE5, 0x03, 0x09,
	0x87, 0xBE, 0xE0, 0x95, 0x25, 0x23, 0x6D, 0x96, 0x72, 0xD8, 0x89, 0x6C,
	0xC6, 0x2E, 0xC3, 0xCC, 0x54, 0x02, 0x9A, 0xB0, 0x7E, 0x9F, 0x62, 0x71,
	0x75, 0x3C, 0x41, 0x1C, 0xDA, 0xEA, 0x99, 0xE3, 0xC5, 0xF2, 0x80, 0x20,
	0xFE, 0x37, 0x3F, 0x5A, 0x4A, 0xC4, 0x43, 0xC1, 0xD3, 0x58, 0xDE, 0x65,
	0x04 };

void Hash32_1_P128(const void* key, int len, unsigned int seed, void* out)
{
	unsigned char* data = (unsigned char*)key;

	unsigned long long length = (unsigned long long)len;

	unsigned long long crc = seed ^ length ^ 0xFFFFFFFFFFFFFFFFLL;

	unsigned char h[P128];

	while (len >= P128){


		for (int i = 0; i < P128; i++)
			h[i] = *data++;


		for (int i = 0; i < P128; i++)
			crc = CRC64_Table[(crc >> 56) ^ (h[i])] ^ (crc << 8);

		len -= P128;


	}

	if (len >= 1){

		for (int i = 0; i < len; i++)
			h[i] = *data++;

		for (int i = len; i < P128; i++)
			h[i] = sbox[i >> 4][i & 0x0F];


		for (int i = 0; i < P128; i++)
			crc = CRC64_Table[(crc >> 56) ^ (h[i])] ^ (crc << 8);


	}

	crc ^= length;

	for (int j = 0; j < 4; j++){



		for (int i = 0; i < 8; i++)
			h[i] = (crc >> (56 - i * 8));


		for (int i = 0; i < 8; i++)
			h[i] = sbox[h[i] >> 4][h[i] & 0x0F];


		crc = (((unsigned long long)h[0]) << 28) | (((unsigned long long)h[1]) << 12)
			| (((unsigned long long)h[2]) << 60) | (((unsigned long long)h[2]) >> 4)
			| (((unsigned long long)h[3]) << 44) | (((unsigned long long)h[4]) << 20)
			| (((unsigned long long)h[5]) << 4) | (((unsigned long long)h[6]) << 52)
			| (((unsigned long long)h[7]) << 36);


	}




	*(unsigned int*)out = (unsigned int)crc;
}











void Hash32_2_P128(const void* key, int len, unsigned int seed, void* out)
{
	unsigned char* data = (unsigned char*)key;

	unsigned long long length = (unsigned long long)len;

	unsigned long long crc = seed ^ length ^ 0xFFFFFFFFFFFFFFFFLL;

	unsigned long long state[8];



	unsigned char h[8][P128];

	while (len >= P128){


		for (int i = 0; i < P128; i++)
			h[0][i] = *data++;


		for (int i = 0; i < P128; i++)
			crc = CRC64_Table[(crc >> 56) ^ (h[0][i])] ^ (crc << 8);

		len -= P128;


	}

	if (len >= 1){

		for (int i = 0; i < len; i++)
			h[0][i] = *data++;

		for (int i = len; i < P128; i++)
			h[0][i] = sbox[i >> 4][i & 0x0F];


		for (int i = 0; i < P128; i++)
			crc = CRC64_Table[(crc >> 56) ^ (h[0][i])] ^ (crc << 8);


	}


	state[4] = crc ^ length;

	for (int j = 0; j < 4; j++){


		for (int i = 0; i < 8; i++){
			h[4][i] = (state[4] >> (56 - i * 8));
		}


		for (int i = 0; i < 8; i++)
			h[4][i] = new_sbox5[h[4][i]];


		state[4] = (((unsigned long long)h[4][0]) << 28) | (((unsigned long long)h[4][1]) << 12)
			| (((unsigned long long)h[4][2]) << 60) | (((unsigned long long)h[4][2]) >> 4)
			| (((unsigned long long)h[4][3]) << 44) | (((unsigned long long)h[4][4]) << 20)
			| (((unsigned long long)h[4][5]) << 4) | (((unsigned long long)h[4][6]) << 52)
			| (((unsigned long long)h[4][7]) << 36);


	}


	*(unsigned int*)out = (unsigned int)state[4];
}














void Hash64_1_P128(const void* key, int len, unsigned int seed, void* out)
{
	unsigned char* data = (unsigned char*)key;

	unsigned long long length = (unsigned long long)len;

	unsigned long long crc = seed ^ length ^ 0xFFFFFFFFFFFFFFFFLL;


	unsigned char h[P128];

	while (len >= P128){


		for (int i = 0; i < P128; i++)
			h[i] = *data++;


		for (int i = 0; i < P128; i++)
			crc = CRC64_Table[(crc >> 56) ^ (h[i])] ^ (crc << 8);

		len -= P128;

	}

	if (len >= 1){

		for (int i = 0; i < len; i++)
			h[i] = *data++;

		for (int i = len; i < P128; i++)
			h[i] = sbox[i >> 4][i & 0x0F];

		for (int i = 0; i < P128; i++)
			crc = CRC64_Table[(crc >> 56) ^ (h[i])] ^ (crc << 8);

	}

	crc ^= length;

	for (int j = 0; j < 4; j++){


		for (int i = 0; i < 8; i++)
			h[i] = (crc >> (56 - i * 8));


		for (int i = 0; i < 8; i++)
			h[i] = sbox[h[i] >> 4][h[i] & 0x0F];


		crc = (((unsigned long long)h[0]) << 28) | (((unsigned long long)h[1]) << 12)
			| (((unsigned long long)h[2]) << 60) | (((unsigned long long)h[2]) >> 4)
			| (((unsigned long long)h[3]) << 44) | (((unsigned long long)h[4]) << 20)
			| (((unsigned long long)h[5]) << 4) | (((unsigned long long)h[6]) << 52)
			| (((unsigned long long)h[7]) << 36);

	}



	*(unsigned long long*)out = crc;
}











void Hash64_2_P128(const void* key, int len, unsigned int seed, void* out)
{
	unsigned char* data = (unsigned char*)key;

	unsigned long long length = (unsigned long long)len;

	unsigned long long crc = seed ^ length ^ 0xFFFFFFFFFFFFFFFFLL;

	unsigned long long state[8];


	unsigned char h[8][P128];

	while (len >= P128){


		for (int i = 0; i < P128; i++)
			h[0][i] = *data++;


		for (int i = 0; i < P128; i++)
			crc = CRC64_Table[(crc >> 56) ^ (h[0][i])] ^ (crc << 8);

		len -= P128;

	}

	if (len >= 1){

		for (int i = 0; i < len; i++)
			h[0][i] = *data++;

		for (int i = len; i < P128; i++)
			h[0][i] = sbox[i >> 4][i & 0x0F];

		for (int i = 0; i < P128; i++)
			crc = CRC64_Table[(crc >> 56) ^ (h[0][i])] ^ (crc << 8);

	}


	state[4] = crc ^ length;

	for (int j = 0; j < 4; j++){


		for (int i = 0; i < 8; i++){
			h[4][i] = (state[4] >> (56 - i * 8));
		}

		for (int i = 0; i < 8; i++)
			h[4][i] = new_sbox5[h[4][i]];


		state[4] = (((unsigned long long)h[4][0]) << 28) | (((unsigned long long)h[4][1]) << 12)
			| (((unsigned long long)h[4][2]) << 60) | (((unsigned long long)h[4][2]) >> 4)
			| (((unsigned long long)h[4][3]) << 44) | (((unsigned long long)h[4][4]) << 20)
			| (((unsigned long long)h[4][5]) << 4) | (((unsigned long long)h[4][6]) << 52)
			| (((unsigned long long)h[4][7]) << 36);

	}


	*(unsigned long long*)out = state[4];
}









void Hash128_1_P128(const void* key, int len, unsigned int seed, void* out)
{
	unsigned char* data = (unsigned char*)key;

	unsigned long long length = (unsigned long long)len;

	unsigned long long crc = seed ^ length ^ 0xFFFFFFFFFFFFFFFFLL;

	unsigned long long state[8];


	unsigned char h[8][P128];

	while (len >= P128){


		for (int i = 0; i < P128; i++)
			h[0][i] = *data++;


		for (int i = 0; i < P128; i++)
			crc = CRC64_Table[(crc >> 56) ^ (h[0][i])] ^ (crc << 8);

		len -= P128;

	}

	if (len >= 1){

		for (int i = 0; i < len; i++)
			h[0][i] = *data++;

		for (int i = len; i < P128; i++)
			h[0][i] = sbox[i >> 4][i & 0x0F];



		for (int i = 0; i < P128; i++)
			crc = CRC64_Table[(crc >> 56) ^ (h[0][i])] ^ (crc << 8);

	}

	state[0] = crc ^ length;
	state[1] = crc ^ length;

	for (int j = 0; j < 4; j++){


		for (int i = 0; i < 8; i++){
			h[0][i] = (state[0] >> (56 - i * 8));
			h[1][i] = (state[1] >> (56 - i * 8));
		}



		for (int i = 0; i < 8; i++){
			h[0][i] = sbox[h[0][i] >> 4][h[0][i] & 0x0F];
			h[1][i] = invsbox[h[1][i] >> 4][h[1][i] & 0x0F];

		}





		state[0] = (((unsigned long long)h[0][0]) << 28) | (((unsigned long long)h[0][1]) << 12)
			| (((unsigned long long)h[0][2]) << 60) | (((unsigned long long)h[0][2]) >> 4)
			| (((unsigned long long)h[0][3]) << 44) | (((unsigned long long)h[0][4]) << 20)
			| (((unsigned long long)h[0][5]) << 4) | (((unsigned long long)h[0][6]) << 52)
			| (((unsigned long long)h[0][7]) << 36);

		state[1] = (((unsigned long long)h[1][0]) << 28) | (((unsigned long long)h[1][1]) << 12)
			| (((unsigned long long)h[1][2]) << 60) | (((unsigned long long)h[1][2]) >> 4)
			| (((unsigned long long)h[1][3]) << 44) | (((unsigned long long)h[1][4]) << 20)
			| (((unsigned long long)h[1][5]) << 4) | (((unsigned long long)h[1][6]) << 52)
			| (((unsigned long long)h[1][7]) << 36);

	}


	((unsigned long long*)out)[0] = state[0];
	((unsigned long long*)out)[1] = state[1];
}












void Hash128_2_P128(const void* key, int len, unsigned int seed, void* out)
{
	unsigned char* data = (unsigned char*)key;

	unsigned long long length = (unsigned long long)len;

	unsigned long long crc = seed ^ length ^ 0xFFFFFFFFFFFFFFFFLL;

	unsigned long long state[8];


	unsigned char h[8][P128];

	while (len >= P128){


		for (int i = 0; i < P128; i++)
			h[0][i] = *data++;


		for (int i = 0; i < P128; i++)
			crc = CRC64_Table[(crc >> 56) ^ (h[0][i])] ^ (crc << 8);

		len -= P128;

	}

	if (len >= 1){

		for (int i = 0; i < len; i++)
			h[0][i] = *data++;

		for (int i = len; i < P128; i++)
			h[0][i] = sbox[i >> 4][i & 0x0F];


		for (int i = 0; i < P128; i++)
			crc = CRC64_Table[(crc >> 56) ^ (h[0][i])] ^ (crc << 8);

	}


	state[4] = crc ^ length;
	state[5] = crc ^ length;

	for (int j = 0; j < 4; j++){


		for (int i = 0; i < 8; i++){
			h[4][i] = (state[4] >> (56 - i * 8));
			h[5][i] = (state[5] >> (56 - i * 8));
		}



		for (int i = 0; i < 8; i++){


			h[4][i] = new_sbox5[h[4][i]];
			h[5][i] = new_sbox2[h[5][i]];

		}



		state[4] = (((unsigned long long)h[4][0]) << 28) | (((unsigned long long)h[4][1]) << 12)
			| (((unsigned long long)h[4][2]) << 60) | (((unsigned long long)h[4][2]) >> 4)
			| (((unsigned long long)h[4][3]) << 44) | (((unsigned long long)h[4][4]) << 20)
			| (((unsigned long long)h[4][5]) << 4) | (((unsigned long long)h[4][6]) << 52)
			| (((unsigned long long)h[4][7]) << 36);

		state[5] = (((unsigned long long)h[5][0]) << 28) | (((unsigned long long)h[5][1]) << 12)
			| (((unsigned long long)h[5][2]) << 60) | (((unsigned long long)h[5][2]) >> 4)
			| (((unsigned long long)h[5][3]) << 44) | (((unsigned long long)h[5][4]) << 20)
			| (((unsigned long long)h[5][5]) << 4) | (((unsigned long long)h[5][6]) << 52)
			| (((unsigned long long)h[5][7]) << 36);


	}


	((unsigned long long*)out)[0] = state[4];
	((unsigned long long*)out)[1] = state[5];
}

